<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Better Boyfriend</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000;
            overflow: hidden;
            touch-action: none;
        }

        /* UI Glass Panel */
        .glass {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.15);
        }

        /* The Ghost Guide Pulse */
        .pulse-animation {
            animation: pulse-guide 3s infinite ease-in-out;
        }

        @keyframes pulse-guide {
            0% {
                opacity: 0.6;
                stroke-width: 2px;
            }

            50% {
                opacity: 0.9;
                stroke-width: 2.5px;
            }

            100% {
                opacity: 0.6;
                stroke-width: 2px;
            }
        }

        /* Success State Animation */
        .guide-success {
            stroke: #00FF00 !important;
            stroke-width: 4px !important;
            filter: drop-shadow(0 0 10px #00FF00);
            transition: all 0.3s ease;
            animation: none;
        }

        /* Sci-Fi Scanner Line */
        .scan-line {
            width: 100%;
            height: 4px;
            background: #00FFFF;
            box-shadow: 0 0 20px #00FFFF, 0 0 10px rgba(0, 255, 255, 0.8);
            position: absolute;
            top: 0;
            left: 0;
            z-index: 20;
            opacity: 0;
        }

        .scanning {
            animation: scan-sci-fi 2.5s ease-in-out infinite;
        }

        @keyframes scan-sci-fi {
            0% {
                top: 0%;
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                top: 100%;
                opacity: 0;
            }
        }

        /* Feedback Text Animation */
        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body class="h-screen w-screen relative text-white">

    <video id="cameraFeed" class="absolute inset-0 w-full h-full object-cover z-0 bg-gray-900" autoplay playsinline
        muted></video>

    <div id="demoImage" class="absolute inset-0 w-full h-full bg-gray-800 z-0 hidden bg-center bg-cover"
        style="background-image: url('https://images.unsplash.com/photo-1543349689-9a4d426bee8e?q=80&w=1000&auto=format&fit=crop');">
    </div>

    <div id="flashOverlay"
        class="absolute inset-0 w-full h-full bg-white opacity-0 pointer-events-none z-50 transition-opacity duration-150">
    </div>
    <div id="scanLine" class="scan-line"></div>

    <div class="absolute inset-0 flex items-center justify-center z-10 pointer-events-none">
        <svg id="ghostGuide" class="w-full h-full max-w-md max-h-[80vh] transition-all duration-500"
            viewBox="0 0 300 600" fill="none" stroke="white" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round">
        </svg>
    </div>

    <div class="absolute inset-0 z-30 flex flex-col justify-between pointer-events-none">

        <div class="w-full p-6 pt-12 flex justify-between items-start">
            <div id="aiStatus" class="bg-black/40 px-3 py-1 rounded-full backdrop-blur-md border border-white/10">
                <span class="text-[10px] font-bold uppercase tracking-[0.2em] text-cyan-400 animate-pulse">AI
                    Scanning</span>
            </div>

            <button onclick="toggleDemoMode()"
                class="pointer-events-auto bg-red-500/10 border border-red-500/30 px-2 py-1 rounded text-[10px] font-mono text-red-200">
                DEBUG
            </button>
        </div>

        <div id="feedbackContainer" class="absolute top-1/3 w-full text-center px-4">
            <div id="feedbackText"
                class="text-cyan-300 font-bold text-lg tracking-widest uppercase drop-shadow-[0_0_10px_rgba(0,255,255,0.8)]">
                ANALYZING SCENE...
            </div>
        </div>

        <div class="w-full glass pb-10 pt-6 rounded-t-[2.5rem] pointer-events-auto shadow-2xl">

            <div class="text-center mb-6">
                <h2 id="poseTitle"
                    class="text-sm font-bold uppercase tracking-[0.2em] text-white transition-all duration-300">
                    The Golden Hour
                </h2>
            </div>

            <div class="flex overflow-x-auto px-6 gap-4 mb-8 no-scrollbar justify-center">
                <button onclick="setPose(0)"
                    class="pose-btn px-4 py-2 rounded-full border border-white/20 bg-white/5 text-[10px] font-bold uppercase tracking-wider transition-all">Golden
                    Hour</button>
                <button onclick="setPose(1)"
                    class="pose-btn px-4 py-2 rounded-full border border-white/20 bg-white/5 text-[10px] font-bold uppercase tracking-wider transition-all">Tourist</button>
                <button onclick="setPose(2)"
                    class="pose-btn px-4 py-2 rounded-full border border-white/20 bg-white/5 text-[10px] font-bold uppercase tracking-wider transition-all">Candid</button>
            </div>

            <div class="flex justify-center items-center">
                <button onclick="capturePhoto()"
                    class="w-20 h-20 rounded-full border-4 border-white/80 flex items-center justify-center active:scale-95 transition-transform shadow-lg bg-white/10">
                    <div class="w-16 h-16 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,0.5)]"></div>
                </button>
            </div>
        </div>
    </div>

    <div id="toast"
        class="absolute top-24 left-1/2 transform -translate-x-1/2 bg-white text-black px-6 py-3 rounded-full shadow-2xl z-50 opacity-0 pointer-events-none font-bold text-xs tracking-widest transition-all duration-500 translate-y-4">
        PERFECT SHOT SAVED
    </div>

    <script>
        // --- CONFIGURATION ---
        const poses = [
            {
                name: "The Golden Hour",
                path: `
                    <rect x="50" y="100" width="200" height="350" rx="20" stroke="inherit" stroke-width="inherit" stroke-dasharray="15 10" opacity="0.8" />
                    <line x1="140" y1="275" x2="160" y2="275" stroke="#00FFFF" stroke-width="2" />
                    <line x1="150" y1="265" x2="150" y2="285" stroke="#00FFFF" stroke-width="2" />
                    <text x="150" y="480" text-anchor="middle" fill="white" font-size="12" font-family="monospace" opacity="0.8">ALIGN BODY</text>
                `,
                // These are the scripted messages the AI will "say"
                feedbackScript: ["Detecting Subject...", "Tilt Head Left...", "Chin Down...", "HOLD STILL", "Perfect Alignment"]
            },
            {
                name: "The Tourist",
                path: `
                    <circle cx="150" cy="180" r="40" stroke="inherit" stroke-width="inherit" stroke-dasharray="8 8" />
                    <path d="M 110 230 L 190 230 L 220 500 L 80 500 Z" stroke="inherit" stroke-width="inherit" stroke-dasharray="10 10" />
                    <line x1="20" y1="500" x2="280" y2="500" stroke="#00FFFF" stroke-width="2" />
                    <text x="150" y="530" text-anchor="middle" fill="#00FFFF" font-size="12" font-family="monospace">FEET HERE</text>
                `,
                feedbackScript: ["Scanning Landmark...", "Step Back...", "Match the Outline...", "HOLD STILL", "Perfect Alignment"]
            },
            {
                name: "The Candid",
                path: `
                    <path d="M 80 150 L 80 120 L 110 120" stroke="#00FFFF" stroke-width="3" fill="none" />
                    <path d="M 220 150 L 220 120 L 190 120" stroke="#00FFFF" stroke-width="3" fill="none" />
                    <circle cx="150" cy="250" r="60" stroke="inherit" stroke-width="inherit" stroke-dasharray="4 4" opacity="0.5" />
                `,
                feedbackScript: ["Face Detected...", "Smile More...", "Too much teeth...", "Natural Smile...", "Perfect Alignment"]
            }
        ];

        // --- ELEMENTS ---
        const video = document.getElementById('cameraFeed');
        const demoDiv = document.getElementById('demoImage');
        const ghostGuide = document.getElementById('ghostGuide');
        const poseTitle = document.getElementById('poseTitle');
        const scanLine = document.getElementById('scanLine');
        const feedbackText = document.getElementById('feedbackText');
        const aiStatus = document.getElementById('aiStatus');
        const toast = document.getElementById('toast');
        const poseBtns = document.querySelectorAll('.pose-btn');

        let isDemo = false;
        let scriptInterval;

        // --- INIT ---
        async function startCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });
                video.srcObject = stream;
            } catch (err) {
                console.warn("Camera failed. Switching to Demo Mode.");
                toggleDemoMode(true);
            }
        }

        window.toggleDemoMode = function (forceOn = false) {
            isDemo = forceOn ? true : !isDemo;
            isDemo ? (video.classList.add('hidden'), demoDiv.classList.remove('hidden')) : (demoDiv.classList.add('hidden'), video.classList.remove('hidden'), startCamera());
            if (isDemo) restartFeedbackLoop(0); // Restart simulation on demo toggle
        }

        // --- POSE LOGIC ---
        window.setPose = function (index) {
            // Reset Visuals
            ghostGuide.classList.remove('guide-success'); // Remove green
            ghostGuide.classList.remove('pulse-animation');
            ghostGuide.style.opacity = 0;

            // Buttons
            poseBtns.forEach((btn, i) => {
                i === index ? btn.classList.add('bg-white/20', 'text-cyan-400') : btn.classList.remove('bg-white/20', 'text-cyan-400');
            });

            setTimeout(() => {
                poseTitle.innerText = poses[index].name;
                ghostGuide.innerHTML = poses[index].path;
                ghostGuide.style.opacity = 1;
                ghostGuide.classList.add('pulse-animation');

                // START THE AI SCRIPT
                restartFeedbackLoop(index);
            }, 200);
        }

        // --- THE "WIZARD OF OZ" AI LOOP ---
        function restartFeedbackLoop(index) {
            clearInterval(scriptInterval);
            const script = poses[index].feedbackScript;
            let step = 0;

            scanLine.classList.add('scanning'); // Start laser

            scriptInterval = setInterval(() => {
                if (step >= script.length) {
                    clearInterval(scriptInterval);
                    return;
                }

                // Update Text
                feedbackText.innerText = script[step];
                feedbackText.classList.remove('fade-in-up');
                void feedbackText.offsetWidth; // trigger reflow
                feedbackText.classList.add('fade-in-up');

                // Logic for "Perfect" state (Last step)
                if (step === script.length - 1) {
                    ghostGuide.classList.remove('pulse-animation');
                    ghostGuide.classList.add('guide-success'); // Turn Green
                    scanLine.classList.remove('scanning'); // Stop laser
                    feedbackText.style.color = "#00FF00"; // Green text
                } else {
                    ghostGuide.classList.remove('guide-success');
                    feedbackText.style.color = "#67e8f9"; // Cyan text
                }

                step++;
            }, 2000); // New instruction every 2 seconds
        }

        window.capturePhoto = function () {
            const flash = document.getElementById('flashOverlay');
            flash.style.opacity = 1;
            setTimeout(() => flash.style.opacity = 0, 150);

            toast.style.opacity = 1;
            toast.style.transform = "translate(-50%, 0)";
            setTimeout(() => {
                toast.style.opacity = 0;
                toast.style.transform = "translate(-50%, 1rem)";
            }, 2000);
        }

        startCamera();
        setPose(0);
    </script>
</body>

</html>